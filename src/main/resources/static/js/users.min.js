let evtSource=new EventSource("/sse/subscribe/users");const usersElem=document.getElementById("usersList");let userTemplate='<div class="card-body row p-4 user-card" onclick=\'redirect(this)\'>\n            <div class="mb-4">\n              <img alt="avatar" class="rounded-circle img-fluid" style="margin-left: 4em;" height="64" width="64" src="%avatar%" />\n              <span class="text-dark username">%username%</span>\n              <span class="text-muted user-id">id=%id%</span>%you%\n            </div>\n          </div>',youTemplate='<span class="text-muted"> (%youText%)</span>';function redirect(e){let a=$(e).find(".user-id").text().split("=")[1];window.location.href="/users/id/"+a}evtSource.addEventListener("createUser",function(e){let a=JSON.parse(e.data),t;t=null!=a.avatar?"data:image;base64,"+a.avatar:"/static/img/default_avatar.png";let r=userTemplate.replace("%username%",a.username).replace("%avatar%",t).replace("%id%",a.id);r=null!=principalId&&a.id==principalId?r.replace("%you%",youTemplate.replace("%youText%",youText)):r.replace("%you%",""),usersElem.insertAdjacentHTML("beforeend",r)}),evtSource.onerror=function(e){switch(this.readyState){case EventSource.CONNECTING:break;case EventSource.CLOSED:evtSource=new EventSource("/sse/subscribe/users")}},$(document).ready(function(){0!=usersList.length&&Array.from(usersList).forEach(e=>{let a;a=null!=e.avatar?"data:image;base64,"+e.avatar:"/static/img/default_avatar.png";let t=userTemplate.replace("%username%",e.username).replace("%avatar%",a).replace("%id%",e.id);t=null!=principalId&&e.id==principalId?t.replace("%you%",youTemplate.replace("%youText%",youText)):t.replace("%you%",""),usersElem.insertAdjacentHTML("beforeend",t)})});